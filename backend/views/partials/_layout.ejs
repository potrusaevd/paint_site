<!DOCTYPE html>
<html lang="ru">
<head>
    <title><%= title %></title>
    <!-- Подключаем ОБЩИЕ стили, которые нужны ВЕЗДЕ -->
    <link rel="shortcut icon" href="images/icons/logo-white.svg" type="image/x-icon"> 
    <link rel="stylesheet" href="/css/root.css">
    <link rel="stylesheet" href="/css/modals.css">
    <link rel="stylesheet" href="/css/header.css">
    <link rel="stylesheet" href="/css/cart.css">

    
    <!-- Сюда вставятся УНИКАЛЬНЫЕ стили для конкретной страницы -->
    <% if (typeof pageStyles !== 'undefined' && pageStyles && pageStyles.length > 0) { %>
        <% pageStyles.forEach(style => { %>
            <link rel="stylesheet" href="<%= style %>">
        <% }); %>
    <% } %>
</head>
<body class="<%= typeof bodyClass !== 'undefined' ? bodyClass : '' %>">
<%- include('_header') %>

    <div class="main-container">
        

        <main class="content">
            <%- body %>
        </main>
    </div>


    <%- include('_modals') %>
    <%- include('_cart') %>


    <svg width="0" height="0" style="position: absolute;">
        <defs>
            <filter id="goo" x="-50%" width="200%" y="-50%" height="200%" color-interpolation-filters="sRGB">
                <feGaussianBlur in="SourceGraphic" stdDeviation="3" result="blur" />
                <feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 21 -7" result="cm" />
            </filter>
            <filter id="goo-light" x="-50%" width="200%" y="-50%" height="200%" color-interpolation-filters="sRGB">
                <feGaussianBlur in="SourceGraphic" stdDeviation="1.25" result="blur" />
                <feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 21 -7" result="cm" />
            </filter>
            <filter id="goo-big" x="-50%" width="200%" y="-50%" height="200%" color-interpolation-filters="sRGB">
                <feGaussianBlur in="SourceGraphic" stdDeviation="7" result="blur" />
                <feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 21 -7" result="cm" />
            </filter>
        </defs>
    </svg>



    <!-- Подключаем ОБЩИЕ скрипты -->
    <script src="/js/userAuth.js" defer></script>
    <script src="/js/global-utils.js" defer></script>
    <script src="/js/main.js" defer></script>
    <script src="/js/header.js"defer></script>
    <script src="/js/clickSpark.js" defer></script>
    <script>
        setTimeout(() => {
            try {
                if (typeof ClickSpark !== 'undefined') {
                    new ClickSpark(document.body, {
                        sparkColor: "#4fa690",
                        sparkSize: 10,
                        sparkRadius: 20,
                        sparkCount: 8,
                        duration: 400,
                        easing: "ease-out",
                        extraScale: 1.0,
                    });
                    console.log('ClickSpark initialized with delay.');
                }
            } catch (error) {
                console.error('Error initializing ClickSpark with delay:', error);
            }
        }, 2000);
    </script>
    
    
    <!-- Сюда вставятся УНИКАЛЬНЫЕ скрипты для конкретной страницы -->
    <% if (typeof pageScripts !== 'undefined' && pageScripts && pageScripts.length > 0) { %>
        <% pageScripts.forEach(script => { %>
            <script src="<%= script %>"></script>
        <% }); %>
    <% } %>

    <!-- === НОВЫЙ БЛОК: ПЕРЕКЛЮЧАТЕЛЬ ТЕМЫ === -->
    <div class="theme-switcher-container">
        <button id="theme-toggle" class="theme-toggle" title="Переключить тему">
            <svg class="sun-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="5"></circle>
                <line x1="12" y1="1" x2="12" y2="3"></line>
                <line x1="12" y1="21" x2="12" y2="23"></line>
                <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                <line x1="1" y1="12" x2="3" y2="12"></line>
                <line x1="21" y1="12" x2="23" y2="12"></line>
                <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
            </svg>
            <svg class="moon-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
            </svg>
        </button>
    </div>

</body> 
</html> 
